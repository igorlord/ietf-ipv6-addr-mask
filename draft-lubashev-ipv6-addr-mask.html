<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>A Recommendation for IPv6 Address/Mask Notation</title>

  
<style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 525px);
    width: 300px;
    z-index: 1;
  }
  #rfc\.toc {
    top: 15px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-right: 350px;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 25px auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc ul {
  margin: 0;
}
/* xml2rfc nests ul directly inside ul which messes with the style badly */
ul.toc, ul.toc>ul, ul.toc ul>ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}
address {
  font-style: normal;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Netmask and Prefix-Length Notations">
<link href="#rfc.section.2" rel="Chapter" title="2 Problem Description">
<link href="#rfc.section.3" rel="Chapter" title="3 Notational Conventions">
<link href="#rfc.section.4" rel="Chapter" title="4 IPv6 Address/Mask Text Representation">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Constraints and Validation">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Examples: groups of addresses">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Examples: specific addresses and groups they belong to">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Textual representation of the Address and Mask">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Use prefix length instead of mask">
<link href="#rfc.section.5" rel="Chapter" title="5 Scoped Mask/Value notation">
<link href="#rfc.section.6" rel="Chapter" title="6 Compatibility and Parser guidelines">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Address Utilization Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 IANA Considerations">
<link href="#rfc.section.10" rel="Chapter" title="10 Change Log">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Since draft-lubashev-ipv6-addr-mask-00">
<link href="#rfc.section.11" rel="Chapter" title="11 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="12 References">
<link href="#rfc.references.1" rel="Chapter" title="12.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="12.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Examples of Semantic Use of Lower Address Bits">
<link href="#rfc.appendix.A.1" rel="Chapter" title="A.1 A Framework for Semantic IPv6 Prefix and Gap Analysis">
<link href="#rfc.appendix.A.2" rel="Chapter" title="A.2 Teredo">
<link href="#rfc.appendix.A.3" rel="Chapter" title="A.3 OpenFlow Switch Configuration">
<link href="#rfc.appendix.A.4" rel="Chapter" title="A.4 TeraStream IPv6 Addressing">
<link href="#rfc.appendix.A.5" rel="Chapter" title="A.5 SURFnet IPv6 Address Plan and incognito Routing Plan">
<link href="#rfc.appendix.A.6" rel="Chapter" title="A.6 Geolocation-based addressing method for IPv6 addresses">
<link href="#rfc.appendix.A.7" rel="Chapter" title="A.7 Customer IDs as low-order bits">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.8.2 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Lubashev, I. and E. Nygren" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-lubashev-ipv6-addr-mask-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-10-16" />
  <meta name="dct.abstract" content="With /48 IPv6 address prefixes assigned to network operators, the operators sometimes find opportunities to devise addressing schemes that assign operational semantics to lower-order bit ranges.  There is currently no standard or interoperable text representation of addresses sharing bit patterns than are not prefixes. This RFC introduces IPv6 Address/Mask notation that allows one to represent address groupings beyond &#8220;all addresses that share a single prefix&#8221;. The representation is similar to the IPv4 address/mask notation in its expressiveness, but it is derived from the familiar address/prefix-length notation for clarity and compatibility with existing parsers." />
  <meta name="description" content="With /48 IPv6 address prefixes assigned to network operators, the operators sometimes find opportunities to devise addressing schemes that assign operational semantics to lower-order bit ranges.  There is currently no standard or interoperable text representation of addresses sharing bit patterns than are not prefixes. This RFC introduces IPv6 Address/Mask notation that allows one to represent address groupings beyond &#8220;all addresses that share a single prefix&#8221;. The representation is similar to the IPv4 address/mask notation in its expressiveness, but it is derived from the familiar address/prefix-length notation for clarity and compatibility with existing parsers." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">IPv6 Operations</td>
<td class="right">I. Lubashev</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">E. Nygren</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">Akamai Technologies</td>
</tr>
<tr>
<td class="left">Expires: April 19, 2018</td>
<td class="right">October 16, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">A Recommendation for IPv6 Address/Mask Notation<br />
  <span class="filename">draft-lubashev-ipv6-addr-mask-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>With /48 IPv6 address prefixes assigned to network operators, the operators sometimes find opportunities to devise addressing schemes that assign operational semantics to lower-order bit ranges.  There is currently no standard or interoperable text representation of addresses sharing bit patterns than are not prefixes. This RFC introduces IPv6 Address/Mask notation that allows one to represent address groupings beyond &#8220;all addresses that share a single prefix&#8221;. The representation is similar to the IPv4 address/mask notation in its expressiveness, but it is derived from the familiar address/prefix-length notation for clarity and compatibility with existing parsers.</p>
<p>For example, using this representation, both 2001:db8::/32 and 2001:db8:://ffff:ffff:: have the same meaning.  However, a group of addresses having the first 32 bits &#8220;2001:0db8::&#8221; and the last 16 bits &#8220;::1234&#8221; requires the new representation: 2001:db8::1234//ffff:ffff::ffff or, equivalently, 2001:db8::1234//32+::ffff.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 19, 2018.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Netmask and Prefix-Length Notations</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Problem Description</a>
</li>
<li>3.   <a href="#rfc.section.3">Notational Conventions</a>
</li>
<li>4.   <a href="#rfc.section.4">IPv6 Address/Mask Text Representation</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Constraints and Validation</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Examples: groups of addresses</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Examples: specific addresses and groups they belong to</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Textual representation of the Address and Mask</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">Use prefix length instead of mask</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Scoped Mask/Value notation</a>
</li>
<li>6.   <a href="#rfc.section.6">Compatibility and Parser guidelines</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Address Utilization Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">IANA Considerations</a>
</li>
<li>10.   <a href="#rfc.section.10">Change Log</a>
</li>
<ul><li>10.1.   <a href="#rfc.section.10.1">Since draft-lubashev-ipv6-addr-mask-00</a>
</li>
</ul><li>11.   <a href="#rfc.section.11">Acknowledgments</a>
</li>
<li>12.   <a href="#rfc.references">References</a>
</li>
<ul><li>12.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>12.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Examples of Semantic Use of Lower Address Bits</a>
</li>
<ul><li>A.1.   <a href="#rfc.appendix.A.1">A Framework for Semantic IPv6 Prefix and Gap Analysis</a>
</li>
<li>A.2.   <a href="#rfc.appendix.A.2">Teredo</a>
</li>
<li>A.3.   <a href="#rfc.appendix.A.3">OpenFlow Switch Configuration</a>
</li>
<li>A.4.   <a href="#rfc.appendix.A.4">TeraStream IPv6 Addressing</a>
</li>
<li>A.5.   <a href="#rfc.appendix.A.5">SURFnet IPv6 Address Plan and incognito Routing Plan</a>
</li>
<li>A.6.   <a href="#rfc.appendix.A.6">Geolocation-based addressing method for IPv6 addresses</a>
</li>
<li>A.7.   <a href="#rfc.appendix.A.7">Customer IDs as low-order bits</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">We have learned to think of IPv4 address groupings in terms of CIDR blocks, because virtually all logical address groupings fit that model well: IP address allocations, subnets, routing announcements, etc.</p>
<p id="rfc.section.1.p.2">With the move to IPv6, the primary mechanism for address grouping remains matching by prefix length, albeit with longer prefix lengths.  This only allows for strictly hierarchical address groupings.  The longer address lengths, however, provide opportunities for assigning operator-specific semantics to bit strings within addresses beyond the prefix, especially when allocating addresses for virtual services.</p>
<p id="rfc.section.1.p.3">Numerous systems (see <a href="#example-systems" class="xref">Appendix A</a> for examples) have been assigning semantics to IPv6 bits that come after IANA prefix bits. These systems attempted to communicate address patterns underlying their system semantics both in documentation and in machine-readable configurations accompanying the systems. Due to the lack of standard textual representation, the documentation often resorted to pictographs and verbose English descriptions. The configuration syntax and parsers were invariably ad hoc and incompatible with other systems.</p>
<p id="rfc.section.1.p.4">Here we define a syntax for representing groupings (matching rules) of IPv6 addresses, where a set of less-significant bits have a particular value.  For example, 2001:db8::1234//ffff:ffff::ffff matches all addresses whose 32 most significant bits are 2001:0db8 and whose 16 least significant bits are 1234.</p>
<p id="rfc.section.1.p.5">This document only concerns itself with the textual representation of address groups that cannot be expressed as CIDR blocks. Our goal is standardizing on a consistent representation to remove a hindrance to interoperability of systems that wish to express rules and policies that apply to such address groups (see <a href="#example-systems" class="xref">Appendix A</a> for examples). Guidance for the applicability of such address groupings is outside the scope of this document.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#current-notations" id="current-notations">Netmask and Prefix-Length Notations</a>
</h1>
<p id="rfc.section.1.1.p.1">There are two common text representations for identifying groups of addresses (networks, subnets, internet routing blocks). These representations can also be used to identify an individual address and its subnet.</p>
<p id="rfc.section.1.1.p.2">The netmask notation described by <a href="#RFC0950" class="xref">[RFC0950]</a> is commonly used for IPv4. It consists of a tuple of a network address and a network mask. For example: 198.51.100.4 netmask 255.255.255.0.</p>
<p id="rfc.section.1.1.p.3">The address/prefix-length notation described by <a href="#RFC4632" class="xref">[RFC4632]</a> is commonly used for both IPv4 and IPv6. It consists of a tuple of a network address and a prefix length. For example: 198.51.100.4/24 or 2001:db8::1234/32.</p>
<p id="rfc.section.1.1.p.4">Depending on the context, netmask and prefix length notations can specify either a &#8220;group of addresses&#8221; or &#8220;an individual address and a group of addresses it belongs to&#8221;.  If the network address contains one or more set bits not selected by the network mask or prefix length, then network address specifies an individual address in addition to the subnet.  For example: 198.51.100.4/24 means &#8220;address 198.51.100.4 within a group of addresses 198.51.100.0 - 198.51.100.255&#8221;.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#problem" id="problem">Problem Description</a>
</h1>
<p id="rfc.section.2.p.1">The problem with the prefix length notation for IPv6 is that it is not sufficiently expressive of IPv6 address groupings for a growing number of applications.</p>
<p id="rfc.section.2.p.2">IPv6 allocation guidelines <a href="#RFC6177" class="xref">[RFC6177]</a> guarantee at least a /48 allocation to network operators and strongly recommend a multi-/64 allocation to end sites. Because these address blocks are orders of magnitude larger than any imaginable number of physical hosts, network operators are managing those addresses in new and creative ways.</p>
<p id="rfc.section.2.p.3">Sometimes, useful address grouping are not &#8220;all addresses that share a prefix of a certain length&#8221;.  Additionally, within an administrative scope, there are use-cases where semantics are assigned to individual bit ranges.</p>
<p id="rfc.section.2.p.4">Consider these examples:</p>
<p></p>

<ol>
<li>Allocating a block of addresses to each host and using the least significant bits to indicate a TLS certificate.  These operators may need a way to express a rule that applies to all traffic that uses a particular TLS certificate.</li>
<li>Network operators managing multiple similar data centers may have different prefixes routed to those data centers but desire a unified set of rules for assigning, managing, and routing IPv6 addresses within those data centers. These operators need to express rules that do not depend on the prefixes of the addresses to which the rules apply.</li>
</ol>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#conventions" id="conventions">Notational Conventions</a>
</h1>
<p id="rfc.section.3.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in <a href="#RFC2119" class="xref">[RFC2119]</a>.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#addr-mask-representation" id="addr-mask-representation">IPv6 Address/Mask Text Representation</a>
</h1>
<p id="rfc.section.4.p.1">This RFC extends address/prefix-length notation of <a href="#RFC4632" class="xref">[RFC4632]</a> in a way that is reminiscent of the IPv4 netmask notation of <a href="#RFC0950" class="xref">[RFC0950]</a>. The address/mask notation allows specifying IPv6 mask instead of the prefix length.</p>
<p id="rfc.section.4.p.2">The address/mask notation is defined as:</p>
<pre>
   ADDRESS // MASK
</pre>
<p id="rfc.section.4.p.3">Both ADDRESS and MASK are IPv6 addresses.  The MASK indicates which bits of the ADDRESS are relevant for the address grouping.  Note that the MASK may be sparse and is not strictly a prefix. For example: 2001:db8::1234//ffff:ffff::ffff.</p>
<p id="rfc.section.4.p.4">The &#8220;//&#8221; was chosen as a separator for address/mask notation, since it is similar to the &#8220;/&#8221; separator used by address/prefix-length (and hence is readily recognizable) but prevents incorrectly parsing address/mask as address/prefix-length.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#validation" id="validation">Constraints and Validation</a>
</h1>
<p id="rfc.section.4.1.p.1">To be a valid definition for just a group of addresses, the ADDRESS part MUST NOT have any bits set outside of the MASK. Otherwise, the ADDRESS // MASK represents an individual address and a group of addresses it belongs to.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#examples-groups-of-addresses" id="examples-groups-of-addresses">Examples: groups of addresses</a>
</h1>
<p></p>

<ol>
<li>2001:db8::1234//ffff:ffff::ffff  <br><br> This specifies IPv6 addresses that look like 2001:db8::1234 when you ignore bits 16-95.</li>
<li>::aa00:1234//::ff00:ffff  <br><br> This specifies IPv6 addresses that have &#8220;aa&#8221; in bits 24-31 and &#8220;1234&#8221; in bits 0-15.</li>
<li>2001:db8:://ffff:ffff::  <br><br> This is equivalent to 2001:db8::/32.</li>
</ol>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#examples-specific-addresses-and-groups-they-belong-to" id="examples-specific-addresses-and-groups-they-belong-to">Examples: specific addresses and groups they belong to</a>
</h1>
<p></p>

<ol>
<li>2001:db8::1:1234//ffff:ffff::ffff  <br><br> This specifies IPv6 address 2001:db8::1:1234 that belongs to a group of addresses that look like 2001:db8::1234 when you ignore bits 16-95.</li>
<li>2001:db8::aa00:1234//::ff00:ffff  <br><br> This specifies IPv6 address 2001:db8::aa00:1234 that belongs to a group of addresses that have &#8220;aa&#8221; in bits 24-31 and &#8220;1234&#8221; in bits 0-15.</li>
<li>2001:db8::1//ffff:ffff::  <br><br> This is equivalent to 2001:db8::1/32.</li>
</ol>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#textual-representation-of-the-address-and-mask" id="textual-representation-of-the-address-and-mask">Textual representation of the Address and Mask</a>
</h1>
<p id="rfc.section.4.4.p.1">When IPv6 mask is used after &#8220;//&#8221;, both the network address and mask parts MUST be formatted as IPv6 addresses and, therefore, their canonical textual representation is dictated by <a href="#RFC5952" class="xref">[RFC5952]</a>.</p>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> <a href="#use-prefix-length-instead-of-mask" id="use-prefix-length-instead-of-mask">Use prefix length instead of mask</a>
</h1>
<p id="rfc.section.4.5.p.1">The canonical representation of a group of IPv6 addresses MUST use a prefix length instead of a mask if possible.  That is, if the mask has all its most-significant bits set, up to some bit, followed by all clear bits, then the canonical representation MUST use a prefix length.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#scoped" id="scoped">Scoped Mask/Value notation</a>
</h1>
<p id="rfc.section.5.p.1">Since assigning operator-specific semantics to bit ranges is only possible within the address space assigned to the operator by IANA, a common use-case is to specify an address/mask within an IANA-assigned prefix scope.  For example, all addresses ending with ::1234 within 2001:db8::/32 can be specified as 2001:db8::1234//ffff:ffff::ffff.</p>
<p id="rfc.section.5.p.2">To make these representations easier to operationally manage and validate, it helps to have an explicit convention for representing prefixes within address groups.  For example, 2001:db8::1234//ffff:ffff::ffff can be represented as 2001:db8::1234//32+::ffff.</p>
<p id="rfc.section.5.p.3">This is specified as:</p>
<pre>
    ADDRESS // PFX_LEN + SCOPED_MASK
</pre>
<p id="rfc.section.5.p.4">Scoped Mask/Value notation representation can be canonicalized using a ADDRESS // MASK notation. The canonical MASK is constructed by performing the bitwise-or of SCOPED_MASK and the mask derived from an address with the PFX_LEN most-significant bits set.</p>
<p id="rfc.section.5.p.5">The the PFX_LEN most-significant bits MUST NOT be set in SCOPED_MASK.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#compatibility" id="compatibility">Compatibility and Parser guidelines</a>
</h1>
<p id="rfc.section.6.p.1">Only parsers that wish to support address groupings that cannot be represented using address/prefix-length are required to support address/mask notation.</p>
<p id="rfc.section.6.p.2">Systems that support communicating address grouping in address/mask notation to other systems SHOULD communicate such grouping in canonical address/prefix-mask notation, if possible.  This ensures compatibility with systems that do not support address/mask notation, if all configured address groupings are proper CIDR prefixes.</p>
<p id="rfc.section.6.p.3">Address groupings that cannot be expressed using address/prefix-length notation MAY be communicated using Scoped Mask/Value (<a href="#scoped" class="xref">Section 5</a>) notation, as long as the PFX_LEN (semantic prefix scope) has been configured via external means (i.e. PFX_LEN SHOULD NOT be automatically derived from the MASK bitmap by the system itself).</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">This document only defines textual representation for IPv6 address groupings.  It does not intend to recommend when assigning semantics to specific bit ranges and matching based on bit substrings is applicable or appropriate.</p>
<p id="rfc.section.7.p.2">IP addresses can be spoofed or be attacker-controlled.  This is especially true of IPv6 addresses differing only in less-significant bits and belonging to different administrative domains.  When used in policies applied to incoming traffic, the MASK part of the address/mask notation SHOULD have as many set bits as the semantics of the policy would allow.</p>
<p id="rfc.section.7.p.3">Operators wishing to assign semantics to bit ranges should be aware that these semantics may be guessable or leaked outside the organization. Hence, there is a risk of privacy/information leakage.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#utilization" id="utilization">Address Utilization Considerations</a>
</h1>
<p id="rfc.section.8.p.1">Since IPv6 allocation guidelines <a href="#RFC6177" class="xref">[RFC6177]</a> guarantee at least a /48 allocation to network operators, it would be an enormous waste of the address space to assign IPv6 addresses only to physical hosts or network interfaces.</p>
<p id="rfc.section.8.p.2">On the other hand, a gratuitous use of lower address bits can lead to a premature address space exhaustion and difficulties in adapting to the future needs of the organization within the assigned address space.  An example of such gratuitous use is designating large parts of the address space for a bitmask, where only a small fraction of all possible bit combinations is utilized.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.9.p.1">This document has no actions for IANA.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#change-log" id="change-log">Change Log</a>
</h1>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> <a href="#since-draft-lubashev-ipv6-addr-mask-00" id="since-draft-lubashev-ipv6-addr-mask-00">Since draft-lubashev-ipv6-addr-mask-00</a>
</h1>
<p></p>

<ul>
<li>Changed separator from &#8220;/&#8221; to &#8220;//&#8221;</li>
<li>Addressed privacy in <a href="#security" class="xref">Section 7</a>
</li>
<li>Added <a href="#compatibility" class="xref">Section 6</a>
</li>
<li>Added <a href="#utilization" class="xref">Section 8</a>
</li>
<li>Added <a href="#example-systems" class="xref">Appendix A</a>
</li>
</ul>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a>
</h1>
<p id="rfc.section.11.p.1">The Acknowledgments will come here.</p>
<h1 id="rfc.references">
<a href="#rfc.references">12.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">12.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC0950">[RFC0950]</b></td>
<td class="top">
<a>Mogul, J.</a> and <a>J. Postel</a>, "<a href="https://tools.ietf.org/html/rfc950">Internet Standard Subnetting Procedure</a>", STD 5, RFC 950, DOI 10.17487/RFC0950, August 1985.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4632">[RFC4632]</b></td>
<td class="top">
<a>Fuller, V.</a> and <a>T. Li</a>, "<a href="https://tools.ietf.org/html/rfc4632">Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan</a>", BCP 122, RFC 4632, DOI 10.17487/RFC4632, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5952">[RFC5952]</b></td>
<td class="top">
<a>Kawamura, S.</a> and <a>M. Kawashima</a>, "<a href="https://tools.ietf.org/html/rfc5952">A Recommendation for IPv6 Address Text Representation</a>", RFC 5952, DOI 10.17487/RFC5952, August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6177">[RFC6177]</b></td>
<td class="top">
<a>Narten, T.</a>, <a>Huston, G.</a> and <a>L. Roberts</a>, "<a href="https://tools.ietf.org/html/rfc6177">IPv6 Address Assignment to End Sites</a>", BCP 157, RFC 6177, DOI 10.17487/RFC6177, March 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">12.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="GeoAddressPatent">[GeoAddressPatent]</b></td>
<td class="top">
<a title="Qualcomm Incorporated">Chen, L.</a>, <a title="Qualcomm Incorporated">Steenstra, J.</a> and <a title="Qualcomm Incorporated">K. Taylor</a>, "<a href="http://patft1.uspto.gov/netacgi/nph-Parser?patentnumber=7929535">US 7929535: Geolocation-based addressing method for IPv6 addresses</a>", April 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.jiang-semantic-prefix">[I-D.jiang-semantic-prefix]</b></td>
<td class="top">
<a>Jiang, S.</a>, <a>Qiong, Q.</a>, <a>Farrer, I.</a>, <a>Bo, Y.</a> and <a>T. Yang</a>, "<a href="https://tools.ietf.org/html/draft-jiang-semantic-prefix-06">Analysis of Semantic Embedded IPv6 Address Schemas</a>", Internet-Draft draft-jiang-semantic-prefix-06, July 2013.</td>
</tr>
<tr>
<td class="reference"><b id="IncognitoRoutingPlan">[IncognitoRoutingPlan]</b></td>
<td class="top">
<a title="incognito">Kostur, A.</a>, "<a href="https://www.incognito.com/tips-and-tutorials/how-to-plan-routing-for-ipv6">How to Plan Routing for IPv6</a>", July 2015.</td>
</tr>
<tr>
<td class="reference"><b id="OpenFlow">[OpenFlow]</b></td>
<td class="top">
<a>Open Networking Foundation</a>, "<a href="https://3vf60mmveq1g8vzn48q2o71a-wpengine.netdna-ssl.com/wp-content/uploads/2014/10/openflow-spec-v1.2.pdf">OpenFlow Switch Specification, Version 1.2</a>", December 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4380">[RFC4380]</b></td>
<td class="top">
<a>Huitema, C.</a>, "<a href="https://tools.ietf.org/html/rfc4380">Teredo: Tunneling IPv6 over UDP through Network Address Translations (NATs)</a>", RFC 4380, DOI 10.17487/RFC4380, February 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6066">[RFC6066]</b></td>
<td class="top">
<a>Eastlake 3rd, D.</a>, "<a href="https://tools.ietf.org/html/rfc6066">Transport Layer Security (TLS) Extensions: Extension Definitions</a>", RFC 6066, DOI 10.17487/RFC6066, January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="SURFnetAddrPlan">[SURFnetAddrPlan]</b></td>
<td class="top">
<a>SURFnet</a>, "<a href="https://www.ipv6forum.com/dl/presentations/IPv6-addressing-plan-howto.pdf">Preparing an IPv6 Address Plan</a>", September 2013.</td>
</tr>
<tr>
<td class="reference"><b id="TeraStream">[TeraStream]</b></td>
<td class="top">
<a title="Deutsche Telekom">Lothberg, P.</a> and <a title="Deutsche Telekom">M. Abrahamsson</a>, "<a href="https://ripe67.ripe.net/presentations/251-ripe2-4.pdf">TeraStream - IPv6 Addressing Format</a>", October 2013.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#example-systems" id="example-systems">Examples of Semantic Use of Lower Address Bits</a>
</h1>
<p id="rfc.section.A.p.1">Assigning semantics to lower bits of IPv6 addresses and defining policies based on such address groupings have been done for many years. Documents describing such policies and configurations for equipment implementing these policies do not use a consistent notation.  Most documents resort to pictographs and verbose English, while the configuration syntax and parsers are invariably ad hoc.</p>
<h1 id="rfc.appendix.A.1">
<a href="#rfc.appendix.A.1">A.1.</a> <a href="#a-framework-for-semantic-ipv6-prefix-and-gap-analysis" id="a-framework-for-semantic-ipv6-prefix-and-gap-analysis">A Framework for Semantic IPv6 Prefix and Gap Analysis</a>
</h1>
<p id="rfc.section.A.1.p.1">Internet draft <a href="#I-D.jiang-semantic-prefix" class="xref">[I-D.jiang-semantic-prefix]</a> describes the need for adding semantics to lower IPv6 address bits to define address groups that cannot be expressed as CIDR blocks and analyzes some implications of this practice. This draft describes uses of such address groups for creating routing policies as well as configuring such policies on hosts and routers both statically and dynamically.</p>
<h1 id="rfc.appendix.A.2">
<a href="#rfc.appendix.A.2">A.2.</a> <a href="#teredo" id="teredo">Teredo</a>
</h1>
<p id="rfc.section.A.2.p.1">Teredo protocol <a href="#RFC4380" class="xref">[RFC4380]</a> uses four bit ranges past Teredo IANA prefix bits to encode server and client IPv4 addresses, a flags bitmap, and a port.</p>
<h1 id="rfc.appendix.A.3">
<a href="#rfc.appendix.A.3">A.3.</a> <a href="#openflow-switch-configuration" id="openflow-switch-configuration">OpenFlow Switch Configuration</a>
</h1>
<p id="rfc.section.A.3.p.1">OpenFlow Switch Specification <a href="#OpenFlow" class="xref">[OpenFlow]</a> describes OpenFlow switch configuration API that can match flows based on an arbitrary IPv6 bitmask applied to IPv6 source (OXM_OF_IPV6_SRC) or destination (OXM_OF_IPV6_DST) addresses. Version 1.2 was the first version to introduce such IPv6 address/bitmask flow match rules (chapter A.2.3.7) in 2011.</p>
<h1 id="rfc.appendix.A.4">
<a href="#rfc.appendix.A.4">A.4.</a> <a href="#terastream-ipv6-addressing" id="terastream-ipv6-addressing">TeraStream IPv6 Addressing</a>
</h1>
<p id="rfc.section.A.4.p.1">TeraStream <a href="#TeraStream" class="xref">[TeraStream]</a> system is using bit ranges to encode service type in IPv6 address bits that come after IANA prefix bits. The system was launched in 2012.</p>
<h1 id="rfc.appendix.A.5">
<a href="#rfc.appendix.A.5">A.5.</a> <a href="#surfnet-ipv6-address-plan-and-incognito-routing-plan" id="surfnet-ipv6-address-plan-and-incognito-routing-plan">SURFnet IPv6 Address Plan and incognito Routing Plan</a>
</h1>
<p id="rfc.section.A.5.p.1">SURFnet published a white paper <a href="#SURFnetAddrPlan" class="xref">[SURFnetAddrPlan]</a> advocating that ISPs use bit ranges past their IANA prefix to encode geo-location and address use types. The white paper is giving examples of a sample address allocation that uses one nibble (bits 68-71) for encoding geo-location and another nibble (bits 64-67) for the use type.</p>
<p id="rfc.section.A.5.p.2">IPv6 Routing Plan <a href="#IncognitoRoutingPlan" class="xref">[IncognitoRoutingPlan]</a> by incognito is advocating allocating bit ranges past an IANA prefix to designate various address attributes, including &#8220;subnet types&#8221;.</p>
<h1 id="rfc.appendix.A.6">
<a href="#rfc.appendix.A.6">A.6.</a> <a href="#geolocation-based-addressing-method-for-ipv6-addresses" id="geolocation-based-addressing-method-for-ipv6-addresses">Geolocation-based addressing method for IPv6 addresses</a>
</h1>
<p id="rfc.section.A.6.p.1">Qualcomm US patent 7,929,535 <a href="#GeoAddressPatent" class="xref">[GeoAddressPatent]</a> describes a method of embedding geo-location information, such as latitude, longitude, altitude, in predefined ranges of bits of an IPv6 address past their IANA prefix.</p>
<h1 id="rfc.appendix.A.7">
<a href="#rfc.appendix.A.7">A.7.</a> <a href="#customer-ids-as-low-order-bits" id="customer-ids-as-low-order-bits">Customer IDs as low-order bits</a>
</h1>
<p id="rfc.section.A.7.p.1">CDNs (and other hosting providers) host web sites belonging to multiple customers using the same servers.  Due to the lack of support for SNI TLS extension <a href="#RFC6066" class="xref">[RFC6066]</a> by some user agents active on the Internet, CDNs resort to using unique IP addresses to identify specific customer domains and, hence, certificates for TLS negotiation.  In case of IPv6 addresses, at least some CDNs use the less significant bits of an IPv6 address to identify customer domains (while the more significant bits carry internal routing information).  The configuration of systems matching lower bits of IPv6 addresses to individual customer domains must use ad hoc syntax due to the lack of a standard way to express semantics of matching on bit ranges other than address prefixes.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Igor Lubashev</span> 
	  <span class="n hidden">
		<span class="family-name">Lubashev</span>
	  </span>
	</span>
	<span class="org vcardline">Akamai Technologies</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:igorlord@alum.mit.edu">igorlord@alum.mit.edu</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Erik Nygren</span> 
	  <span class="n hidden">
		<span class="family-name">Nygren</span>
	  </span>
	</span>
	<span class="org vcardline">Akamai Technologies</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:erik+ietf@nygren.org">erik+ietf@nygren.org</a></span>

<span class="vcardline">URI: <a href="http://erik.nygren.org/">http://erik.nygren.org/</a></span>

  </address>
</div>

</body>
</html>
